<!DOCTYPE html>
<html ng-app="pwdt">
<head>
  <% include ../partials/header.ejs %>
</head>

<body ng-controller="mainController">

  <% include ../partials/nav.ejs %>

<div class="jumbotron text-center">
  <div class="container">
    <h1>PlasmaPilot</h1>
    <p>PlasmaPilot is based on experimentally defined, bottom-up human plasma proteomics.</p>
    <p>Our goal is provide a prospective sample preparation guide for the quantitative MS-based analysis of a list of 757* plasma proteins.</p>
  </div>
</div>
<div class="container">
  <div class="row">
    <div class="col-md-6">
      <div class="form">
        <form>
          <div class="form-group">
            <label>Enter Uniprot ID or Gene Name of Proteins:</label>
            <textarea class="form-control" placeholder="Q53GG5, GSTP1" rows="3" ng-model="proteinData.text"></textarea>
          </div>
          <label>Select Analytical Requirement:</label>
          <br>
          <div class="radio-inline">
            <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios1" ng-model="specificity.text" ng-init="specificity.text='identified'" value="identified" ng-click="updateChart(specificity.text)" checked>
            <span class="form-check-label">
              Identified
            </span>
          </div>
          <div class="radio-inline">
            <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios2" ng-model="specificity.text" value="quantified" ng-click="updateChart(specificity.text)">
            <span class="form-check-label">
              Quantified
            </span>
          </div>
          <div class="radio-inline">
            <input class="form-check-input" type="radio" name="exampleRadios" id="exampleRadios3" ng-model="specificity.text" value="good_linearity" ng-click="updateChartLinearity(specificity.text)">
            <span class="form-check-label">
              Linear Range (r<sup>2</sup> > 0.8)
            </span>
          </div>
          <button class="btn btn-danger pull-right" type="submit" ng-click="query()">Submit</button>
        </form>
      </div>
      <br>
      <div class="list">
        <label class="ng-cloak" ng-show="exceptData.length > 0">Proteins not in database: </label>
        <label class="ng-cloak" ng-show="exceptData.length > 0" ng-repeat="except in exceptData">&nbsp;{{ except.unnest }}{{$last ? '' : ','}}</lable>
      </div>
      <br ng-show="exceptData.length > 0">

      <label ng-cloak ng-show="queryData.length > 0">Analysis Results</label>
      <form class="form-inline">
        <div class="form-group-inline">
          <label ng-cloak ng-show="queryData.length > 0">Search</label>
          <input ng-cloak ng-show="queryData.length > 0" type="text" ng-model="search" class="form-control" placeholder="Search">

          <label id="items" ng-cloak ng-show="queryData.length > 0">Items Per Page</label>
          <div class="btn-group">
            <button id="pagination" ng-cloak ng-show="queryData.length > 0" type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false" ng-model="p">
               {{p}} <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
              <li><a ng-click="updatePageSize('5')">5</a></li>
              <li><a ng-click="updatePageSize('10')">10</a></li>
              <li><a ng-click="updatePageSize('50')">50</a></li>
              <li><a ng-click="updatePageSize('100')">100</a></li>
            </ul>
          </div>
        </div>
      </form>

      <table ng-cloak id="example" class="table table-bordered table-striped" ng-show="queryData.length > 0">
        <thread>
          <tr>
            <th scope="col">Uniprot ID</th>
            <th scope="col">Gene Name</th>
            <th scope="col">Entry Name</th>
            <th scope="col">Protein Name</th>
            <th scope="col" ng-show="specificity.text == 'identified'">Identified</th>
            <th scope="col" ng-show="specificity.text == 'identified'">Recommendation</th>
            <th scope="col" ng-show="specificity.text == 'quantified'">Quantified</th>
            <th scope="col" ng-show="specificity.text == 'quantified'">Recommendation</th>
            <th scope="col" ng-show="specificity.text == 'good_linearity'">Linear Range</th>
            <th scope="col" ng-show="specificity.text == 'good_linearity'">Recommendation</th>
          </tr>
        </thread>
        <tbody>
          <tr dir-paginate="query in queryData|itemsPerPage:p">
<!--           <tr dir-paginate="query in queryData|myFilter:search|itemsPerPage:p"> -->
<!--           <tr dir-paginate="query in queryData|customSearch:search:specificity|itemsPerPage:p"> -->
            <td class="ng-cloak">&nbsp;{{ query.swiss_prot_id }}</td>
            <td class="ng-cloak">&nbsp;{{ query.gene_name }}</td>
            <td class="ng-cloak">&nbsp;{{ query.entry_name }}</td>
            <td class="ng-cloak">&nbsp;{{ query.protein_name }}</td>
            <td class="ng-cloak" ng-show="specificity.text == 'identified'">&nbsp;{{ query.identified=='#N/A'? 'N/A' : query.identified }}</td>
            <td class="ng-cloak" ng-show="specificity.text == 'identified'">&nbsp;{{ query.identified=='Both'? 'Undepleted' : query.identified=='#N/A'? 'Cannot be identified in either' : query.identified }}</td>
            <td class="ng-cloak" ng-show="specificity.text == 'quantified'">&nbsp;{{ query.quantified=='#N/A'? 'N/A' : query.quantified }}</td>
            <td class="ng-cloak" ng-show="specificity.text == 'quantified'">&nbsp;{{ query.quantified=='Both'? 'Undepleted' : query.quantified=='#N/A'? 'Cannot be quantified in either' : query.quantified }}</td>
            <td class="ng-cloak" ng-show="specificity.text == 'good_linearity'">&nbsp;{{ query.good_linearity=='#N/A'? 'N/A' : query.good_linearity }}</td>
            <td class="ng-cloak" ng-show="specificity.text == 'good_linearity'">&nbsp;{{ query.good_linearity=='#N/A'? 'Outside linear range' : query.good_linearity!='Both'? query.good_linearity : query.broader_linear_range=='Same'? 'Undepleted' : query.broader_linear_range }}</td>
          </tr>
        </tbody>
      </table>
      <div>
        <dir-pagination-controls max-size="5" direction-links="true" boundary-links="true" ></dir-pagination-controls>
        <button border-radius: 2px; type="button" ng-cloak ng-show="queryData.length > 0" ng-click="export()" id="exportButton" class="btn btn-primary clearfix float-right text-right"><span class="fa fa-file-excel-o"></span> Export</button>
      </div>

<!-- Hidden table to be exported -->
      <table hidden id="export" class="table table-bordered table-striped">
        <thread>
          <tr>
            <th scope="col">Uniprot ID</th>
            <th scope="col">Gene Name</th>
            <th scope="col">Entry Name</th>
            <th scope="col">Protein Name</th>
            <th scope="col">Identified</th>
            <th scope="col">Recommendation</th>
            <th scope="col">Quantified</th>
            <th scope="col">Recommendation</th>
            <th scope="col">Linear Range</th>
            <th scope="col">Recommendation</th>
          </tr>
        </thread>
        <tbody>
          <tr ng-repeat="query in queryData">
            <td>&nbsp;{{ query.swiss_prot_id }}</td>
            <td>&nbsp;{{ query.gene_name }}</td>
            <td>&nbsp;{{ query.entry_name }}</td>
            <td>&nbsp;{{ query.protein_name }}</td>
            <td>&nbsp;{{ query.identified=='#N/A'? 'N/A' : query.identified }}</td>
            <td>&nbsp;{{ query.identified=='Both'? 'Undepleted' : query.identified=='#N/A'? 'Cannot be identified in either' : query.identified }}</td>
            <td>&nbsp;{{ query.quantified=='#N/A'? 'N/A' : query.quantified }}</td>
            <td>&nbsp;{{ query.quantified=='Both'? 'Undepleted' : query.quantified=='#N/A'? 'Cannot be quantified in either' : query.quantified }}</td>
            <td>&nbsp;{{ query.good_linearity=='#N/A'? 'N/A' : query.good_linearity }}</td>
            <td>&nbsp;{{ query.good_linearity=='#N/A'? 'Outside linear range' : query.good_linearity!='Both'? query.good_linearity : query.broader_linear_range=='Same'? 'Undepleted' : query.broader_linear_range }}</td>
          </tr>
        </tbody>
      </table>

<!--       <table class="table table-bordered table-striped">
        <thread>
          <tr>
            <th scope="col">Swiss Prot ID</th>
            <th scope="col">Gene Name</th>
            <th scope="col">Entry Name</th>
            <th scope="col">Protein Name</th>
            <th scope="col">Identified</th>
            <th scope="col">Quantified</th>
            <th scope="col">Good Linearity</th>
            <th scope="col">Broader Linear Range</th>
          </tr>
        </thread>
        <tbody>
          <tr ng-repeat="todo in todoData">
            <td class="ng-cloak">&nbsp;{{ todo.swiss_prot_id }}</td>
            <td class="ng-cloak">&nbsp;{{ todo.gene_name }}</td>
            <td class="ng-cloak">&nbsp;{{ todo.entry_name }}</td>
            <td>&nbsp;{{ todo.protein_name }}</td>
            <td class="ng-cloak">&nbsp;{{ todo.identified }}</td>
            <td class="ng-cloak">&nbsp;{{ todo.quantified }}</td>
            <td class="ng-cloak">&nbsp;{{ todo.good_linearity }}</td>
            <td class="ng-cloak">&nbsp;{{ todo.broader_linear_range }}</td>
          </tr>
        </tbody>
      </table> -->
    </div>
    <div class="col-md-6">
      <div class="demo-container" ng-app="pwdt" ng-controller="chartController">
        <div id="chart" dx-chart="chartOptions"></div>
      </div>
    </div>
  </div>
</div>
<!-- <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.3/jquery.min.js"></script>
<script type="text/javascript" src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.4/js/bootstrap.min.js"></script> -->

<!-- <script src="//code.jquery.com/jquery-2.2.4.min.js" type="text/javascript"></script> -->
<script src="//maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" type="text/javascript"></script>
<script src="javascripts/app.js"></script>
</body>
</html>